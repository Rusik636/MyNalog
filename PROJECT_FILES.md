# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ RuRus Nalog

## üèóÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

### üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- **`pyproject.toml`** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Python –ø—Ä–æ–µ–∫—Ç–∞, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **`README.md`** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (383 —Å—Ç—Ä–æ–∫–∏)
- **`MIGRATION_REPORT.md`** - –ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç –æ –º–∏–≥—Ä–∞—Ü–∏–∏ PHP ‚Üí Python

### üéØ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
- **`demo.py`** - –†–∞–±–æ—á–∏–µ –ø—Ä–∏–º–µ—Ä—ã –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

### üöÄ CI/CD
- **`.github/workflows/ci.yml`** - GitHub Actions –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ª–∏–Ω—Ç–∏–Ω–≥–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üì¶ –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (`rurus_nalog/`)

### üîß –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
- **`__init__.py`** - –ü—É–±–ª–∏—á–Ω—ã–π API, —ç–∫—Å–ø–æ—Ä—Ç –∫–ª–∞—Å—Å–æ–≤ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- **`client.py`** - –ì–ª–∞–≤–Ω—ã–π —Ñ–∞—Å–∞–¥ Client —Å —Ñ–∞–±—Ä–∏—á–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ (203 —Å—Ç—Ä–æ–∫–∏)
- **`_http.py`** - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π HTTP –∫–ª–∏–µ–Ω—Ç —Å middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (170 —Å—Ç—Ä–æ–∫)
- **`auth.py`** - –ü—Ä–æ–≤–∞–π–¥–µ—Ä –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ AuthProviderImpl (277 —Å—Ç—Ä–æ–∫)

### üìä API –º–æ–¥—É–ª–∏
- **`income.py`** - Income API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ—Ç–º–µ–Ω—ã —á–µ–∫–æ–≤ (150 —Å—Ç—Ä–æ–∫)
- **`receipt.py`** - Receipt API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ–∫–æ–≤ (74 —Å—Ç—Ä–æ–∫–∏)
- **`exceptions.py`** - –ò–µ—Ä–∞—Ä—Ö–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏ –º–∞–ø–ø–∏–Ω–≥ HTTP –∫–æ–¥–æ–≤ (95 —Å—Ç—Ä–æ–∫)

### üìã DTO –º–æ–¥–µ–ª–∏ (`dto/`)
- **`__init__.py`** - –≠–∫—Å–ø–æ—Ä—Ç DTO –∫–ª–∞—Å—Å–æ–≤
- **`income.py`** - Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è Income API (242 —Å—Ç—Ä–æ–∫–∏)
  - `IncomeServiceItem` - –ø–æ–∑–∏—Ü–∏—è —á–µ–∫–∞
  - `IncomeClient` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ
  - `IncomeRequest` / `CancelRequest` - –∑–∞–ø—Ä–æ—Å—ã –∫ API
  - `AtomDateTime` - —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—Ç –≤ ISO —Ñ–æ—Ä–º–∞—Ç
  - Enums: `IncomeType`, `PaymentType`, `CancelCommentType`

## üß™ –¢–µ—Å—Ç—ã (`tests/`)

### üìù –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã (46 —Ç–µ—Å—Ç–æ–≤ total)
- **`__init__.py`** - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞ —Ç–µ—Å—Ç–æ–≤
- **`test_auth_async.py`** - –¢–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (14 —Ç–µ—Å—Ç–æ–≤, 293 —Å—Ç—Ä–æ–∫–∏)
  - AuthProviderImpl: —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤, phone challenge, refresh
  - Client: –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  - RefreshMiddleware: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ 401
- **`test_income_async.py`** - –¢–µ—Å—Ç—ã Income API (22 —Ç–µ—Å—Ç–∞, 395 —Å—Ç—Ä–æ–∫)
  - –°–æ–∑–¥–∞–Ω–∏–µ —á–µ–∫–æ–≤ (single/multiple items)
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ (—Ñ–∏–∑/—é—Ä –ª–∏—Ü–∞)
  - –û—Ç–º–µ–Ω–∞ —á–µ–∫–æ–≤
  - DTO –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
- **`test_receipt_async.py`** - –¢–µ—Å—Ç—ã Receipt API (10 —Ç–µ—Å—Ç–æ–≤, 185 —Å—Ç—Ä–æ–∫)
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è URL –¥–ª—è –ø–µ—á–∞—Ç–∏
  - –ü–æ–ª—É—á–µ–Ω–∏–µ JSON –¥–∞–Ω–Ω—ã—Ö —á–µ–∫–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ñ–∞–π–ª–∞–º

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ (–ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏)
```
rurus_nalog/_http.py      63 —Å—Ç—Ä–æ–∫–∏   90% –ø–æ–∫—Ä—ã—Ç–∏–µ
rurus_nalog/auth.py       88 —Å—Ç—Ä–æ–∫    80% –ø–æ–∫—Ä—ã—Ç–∏–µ
rurus_nalog/client.py     38 —Å—Ç—Ä–æ–∫    89% –ø–æ–∫—Ä—ã—Ç–∏–µ
rurus_nalog/income.py     39 —Å—Ç—Ä–æ–∫   100% –ø–æ–∫—Ä—ã—Ç–∏–µ ‚úÖ
rurus_nalog/receipt.py    18 —Å—Ç—Ä–æ–∫   100% –ø–æ–∫—Ä—ã—Ç–∏–µ ‚úÖ
rurus_nalog/exceptions.py 38 —Å—Ç—Ä–æ–∫    68% –ø–æ–∫—Ä—ã—Ç–∏–µ
rurus_nalog/dto/income.py 111 —Å—Ç—Ä–æ–∫   92% –ø–æ–∫—Ä—ã—Ç–∏–µ
```

### üìã –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 397 (–æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
- **–¢–µ—Å—Ç–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫:** 873 (–≤ 3 —Ñ–∞–π–ª–∞—Ö)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 466 —Å—Ç—Ä–æ–∫ (README + –æ—Ç—á—ë—Ç—ã)
- **–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:** 88%

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### üêç Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```toml
# –û—Å–Ω–æ–≤–Ω—ã–µ
httpx>=0.25.0        # Async HTTP client
pydantic>=2.0.0      # DTO validation
python-dotenv>=1.0.0 # Config management

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞  
pytest>=7.0.0        # Testing framework
pytest-asyncio>=0.21.0 # Async test support
respx>=0.20.0        # HTTP mocking
ruff>=0.1.0          # Linting
black>=23.0.0        # Code formatting
mypy>=1.0.0          # Type checking
coverage>=7.0.0      # Test coverage
```

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** httpx.AsyncClient + asyncio
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è:** Pydantic v2 + mypy
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:** —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:** 88% –ø–æ–∫—Ä—ã—Ç–∏–µ —Å async —Ç–µ—Å—Ç–∞–º–∏
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** 100% API —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å PHP –≤–µ—Ä—Å–∏–µ–π

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

### üóÇÔ∏è –°–ª—É–∂–µ–±–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- **`.pytest_cache/`** - –ö—ç—à pytest
- **`rurus_nalog.egg-info/`** - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
- **`__pycache__/`** - –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Python —Ñ–∞–π–ª—ã
- **`.coverage`** - –î–∞–Ω–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏

### üîç –ò—Å—Ö–æ–¥–Ω—ã–π PHP –ø—Ä–æ–µ–∫—Ç (`PHPLibMoyNalog/`)
- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è PHP –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ reference implementation
- –°–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Å—Ç—ã, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –ø—Ä–∏–º–µ—Ä—ã

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```python
from rurus_nalog import Client

client = Client()
token = await client.create_new_access_token("inn", "password")
await client.authenticate(token)

# –°–æ–∑–¥–∞—Ç—å —á–µ–∫
income_api = client.income()  
result = await income_api.create("–£—Å–ª—É–≥–∞", 1000, 1)

# –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ–∫–∞
receipt_api = client.receipt()
receipt_data = await receipt_api.json(result["approvedReceiptUuid"])
```

### üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
pytest tests/ -v                    # –í—Å–µ —Ç–µ—Å—Ç—ã
python -m coverage run -m pytest    # –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
python demo.py                      # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
```

---

**–ò—Ç–æ–≥–æ:** –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å 88% –ø–æ–∫—Ä—ã—Ç–∏–µ–º —Ç–µ—Å—Ç–∞–º–∏, –≥–æ—Ç–æ–≤–∞—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.
